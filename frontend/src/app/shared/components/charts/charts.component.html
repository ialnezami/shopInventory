<div class="charts-container" [style.height]="height" [style.width]="width">
  <!-- Chart Controls -->
  <div class="chart-controls" *ngIf="!dashboardMode">
    <div class="control-group">
      <label for="chart-type">Chart Type:</label>
      <select 
        id="chart-type"
        class="form-select form-select-sm"
        [value]="chartType"
        (change)="changeChartType($event.target.value as any)">
        <option value="line">Line Chart</option>
        <option value="bar">Bar Chart</option>
        <option value="pie">Pie Chart</option>
        <option value="doughnut">Doughnut Chart</option>
        <option value="radar">Radar Chart</option>
        <option value="polarArea">Polar Area</option>
      </select>
    </div>

    <div class="control-group">
      <label for="chart-height">Height:</label>
      <input 
        id="chart-height"
        type="text"
        class="form-control form-control-sm"
        [value]="height"
        (input)="height = $event.target.value">
    </div>

    <div class="control-group">
      <button 
        class="btn btn-outline-primary btn-sm"
        (click)="exportChart('png')">
        Export PNG
      </button>
      <button 
        class="btn btn-outline-primary btn-sm"
        (click)="exportChart('jpg')">
        Export JPG
      </button>
    </div>
  </div>

  <!-- Dashboard Mode -->
  <div *ngIf="dashboardMode" class="dashboard-container">
    <div class="dashboard-header">
      <h3>Analytics Dashboard</h3>
      <div class="dashboard-controls">
        <button 
          class="btn btn-outline-secondary btn-sm"
          (click)="generateSampleSalesData()">
          Load Sales Data
        </button>
        <button 
          class="btn btn-outline-secondary btn-sm"
          (click)="generateSampleInventoryData()">
          Load Inventory Data
        </button>
        <button 
          class="btn btn-outline-secondary btn-sm"
          (click)="generateSampleRevenueData()">
          Load Revenue Data
        </button>
      </div>
    </div>

    <!-- Dashboard Widgets Grid -->
    <div class="widgets-grid">
      <!-- Sales Trend Chart Widget -->
      <div class="widget widget-large" [class]="'widget-' + widgets[0]?.size || 'medium'">
        <div class="widget-header">
          <h4>Sales Trends</h4>
          <div class="widget-actions">
            <button 
              class="btn btn-sm btn-outline-secondary"
              (click)="resizeWidget('sales-trend', 'small')">
              S
            </button>
            <button 
              class="btn btn-sm btn-outline-secondary"
              (click)="resizeWidget('sales-trend', 'medium')">
              M
            </button>
            <button 
              class="btn btn-sm btn-outline-secondary"
              (click)="resizeWidget('sales-trend', 'large')">
              L
            </button>
          </div>
        </div>
        <div class="widget-content">
          <canvas #chartCanvas id="sales-chart"></canvas>
        </div>
      </div>

      <!-- Inventory Chart Widget -->
      <div class="widget widget-medium" [class]="'widget-' + widgets[1]?.size || 'medium'">
        <div class="widget-header">
          <h4>Inventory by Category</h4>
          <div class="widget-actions">
            <button 
              class="btn btn-sm btn-outline-secondary"
              (click)="resizeWidget('inventory', 'small')">
              S
            </button>
            <button 
              class="btn btn-sm btn-outline-secondary"
              (click)="resizeWidget('inventory', 'medium')">
              M
            </button>
            <button 
              class="btn btn-sm btn-outline-secondary"
              (click)="resizeWidget('inventory', 'large')">
              L
            </button>
          </div>
        </div>
        <div class="widget-content">
          <canvas #chartCanvas id="inventory-chart"></canvas>
        </div>
      </div>

      <!-- Revenue Metrics Widget -->
      <div class="widget widget-small" [class]="'widget-' + widgets[2]?.size || 'small'">
        <div class="widget-header">
          <h4>Revenue Metrics</h4>
        </div>
        <div class="widget-content">
          <div class="metrics-grid">
            <div class="metric-item">
              <div class="metric-value">$45,000</div>
              <div class="metric-label">Q1 Revenue</div>
            </div>
            <div class="metric-item">
              <div class="metric-value">$52,000</div>
              <div class="metric-label">Q2 Revenue</div>
            </div>
            <div class="metric-item">
              <div class="metric-value">$48,000</div>
              <div class="metric-label">Q3 Revenue</div>
            </div>
            <div class="metric-item">
              <div class="metric-value">$61,000</div>
              <div class="metric-label">Q4 Revenue</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions Widget -->
      <div class="widget widget-small" [class]="'widget-' + widgets[3]?.size || 'small'">
        <div class="widget-header">
          <h4>Quick Actions</h4>
        </div>
        <div class="widget-content">
          <div class="quick-actions">
            <button class="btn btn-primary btn-sm w-100 mb-2">
              <i class="bi bi-plus-circle"></i> Add Product
            </button>
            <button class="btn btn-success btn-sm w-100 mb-2">
              <i class="bi bi-cart-plus"></i> New Sale
            </button>
            <button class="btn btn-info btn-sm w-100 mb-2">
              <i class="bi bi-file-earmark-text"></i> Generate Report
            </button>
            <button class="btn btn-warning btn-sm w-100">
              <i class="bi bi-gear"></i> Settings
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Single Chart Mode -->
  <div *ngIf="!dashboardMode" class="chart-container">
    <div class="chart-wrapper" [style.height]="height">
      <canvas #chartCanvas></canvas>
    </div>
  </div>

  <!-- Chart Interaction Info -->
  <div class="chart-info" *ngIf="!dashboardMode">
    <div class="info-item">
      <strong>Chart Type:</strong> {{ chartType | titlecase }}
    </div>
    <div class="info-item">
      <strong>Data Points:</strong> {{ chartData.labels.length }}
    </div>
    <div class="info-item">
      <strong>Datasets:</strong> {{ chartData.datasets.length }}
    </div>
  </div>
</div>
